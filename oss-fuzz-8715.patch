From 308b7ca12352b741c4f11b4b7685ef71fa66d50a Mon Sep 17 00:00:00 2001
From: Vincent Le Garrec <legarrec.vincent@gmail.com>
Date: Sat, 2 Feb 2019 04:40:08 +0100
Subject: [PATCH] Integer-overflow in Gfx8BitFont::Gfx8BitFont

oss-fuzz/8715
---
 poppler/GfxFont.cc | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/poppler/GfxFont.cc b/poppler/GfxFont.cc
index cc538f8b..f0c710d9 100644
--- a/poppler/GfxFont.cc
+++ b/poppler/GfxFont.cc
@@ -34,6 +34,7 @@
 // Copyright (C) 2014 Olly Betts <olly@survex.com>
 // Copyright (C) 2018 KlarÃ¤lvdalens Datakonsult AB, a KDAB Group company, <info@kdab.com>. Work sponsored by the LiMux project of the city of Munich
 // Copyright (C) 2018 Adam Reichold <adam.reichold@t-online.de>
+// Copyright (C) 2019 LE GARREC Vincent <legarrec.vincent@gmail.com>
 //
 // To see a description of the changes please see the Changelog file that
 // came with your tarball or type make ChangeLog if you are building from git
@@ -1224,8 +1225,8 @@ Gfx8BitFont::Gfx8BitFont(XRef *xref, const char *tagA, Ref idA, GooString *nameA
 	    }
 	    enc[code] = copyString(obj3.getName());
 	    encFree[code] = true;
+	    ++code;
 	  }
-	  ++code;
 	} else {
 	  error(errSyntaxError, -1,
 		"Wrong type in font encoding resource differences ({0:s})",
-- 
2.18.1

