From f2493d53a70e10ea69bd147c48be7c8544979436 Mon Sep 17 00:00:00 2001
From: Albert Astals Cid <aacid@kde.org>
Date: Fri, 25 Jan 2019 19:49:54 +0100
Subject: [PATCH] SampledFunction: Fix uninitialized memory read

oss-fuzz/12608
---
 poppler/Function.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/poppler/Function.cc b/poppler/Function.cc
index cb8fae5c..2b882885 100644
--- a/poppler/Function.cc
+++ b/poppler/Function.cc
@@ -276,7 +276,7 @@ SampledFunction::SampledFunction(Object *funcObj, Dict *dict) {
       }
       idx = (idx + bit) * sampleSize[j-1];
     }
-    if (sampleSize[0] == 1) {
+    if (m > 0 && sampleSize[0] == 1) {
       bit = 0;
     } else {
       bit = (t >> (m - 1)) & 1;
-- 
2.18.1

